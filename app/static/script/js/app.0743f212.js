(function(){var s={6700:function(s,e,t){var o={"./af":3906,"./af.js":3906,"./ar":902,"./ar-dz":3853,"./ar-dz.js":3853,"./ar-kw":299,"./ar-kw.js":299,"./ar-ly":6825,"./ar-ly.js":6825,"./ar-ma":6379,"./ar-ma.js":6379,"./ar-ps":3639,"./ar-ps.js":3639,"./ar-sa":7700,"./ar-sa.js":7700,"./ar-tn":2059,"./ar-tn.js":2059,"./ar.js":902,"./az":6043,"./az.js":6043,"./be":7936,"./be.js":7936,"./bg":4078,"./bg.js":4078,"./bm":4014,"./bm.js":4014,"./bn":9554,"./bn-bd":7114,"./bn-bd.js":7114,"./bn.js":9554,"./bo":6529,"./bo.js":6529,"./br":5437,"./br.js":5437,"./bs":9647,"./bs.js":9647,"./ca":9951,"./ca.js":9951,"./cs":6113,"./cs.js":6113,"./cv":7965,"./cv.js":7965,"./cy":5858,"./cy.js":5858,"./da":3515,"./da.js":3515,"./de":2831,"./de-at":6263,"./de-at.js":6263,"./de-ch":1127,"./de-ch.js":1127,"./de.js":2831,"./dv":4510,"./dv.js":4510,"./el":8616,"./el.js":8616,"./en-au":4595,"./en-au.js":4595,"./en-ca":3545,"./en-ca.js":3545,"./en-gb":9609,"./en-gb.js":9609,"./en-ie":3727,"./en-ie.js":3727,"./en-il":3302,"./en-il.js":3302,"./en-in":6305,"./en-in.js":6305,"./en-nz":9128,"./en-nz.js":9128,"./en-sg":4569,"./en-sg.js":4569,"./eo":650,"./eo.js":650,"./es":6358,"./es-do":4214,"./es-do.js":4214,"./es-mx":8639,"./es-mx.js":8639,"./es-us":232,"./es-us.js":232,"./es.js":6358,"./et":7279,"./et.js":7279,"./eu":5515,"./eu.js":5515,"./fa":7981,"./fa.js":7981,"./fi":7090,"./fi.js":7090,"./fil":9208,"./fil.js":9208,"./fo":2799,"./fo.js":2799,"./fr":3463,"./fr-ca":2213,"./fr-ca.js":2213,"./fr-ch":2848,"./fr-ch.js":2848,"./fr.js":3463,"./fy":1468,"./fy.js":1468,"./ga":8163,"./ga.js":8163,"./gd":2898,"./gd.js":2898,"./gl":6312,"./gl.js":6312,"./gom-deva":682,"./gom-deva.js":682,"./gom-latn":9178,"./gom-latn.js":9178,"./gu":1400,"./gu.js":1400,"./he":2795,"./he.js":2795,"./hi":7009,"./hi.js":7009,"./hr":6506,"./hr.js":6506,"./hu":9565,"./hu.js":9565,"./hy-am":3864,"./hy-am.js":3864,"./id":5626,"./id.js":5626,"./is":6649,"./is.js":6649,"./it":151,"./it-ch":5348,"./it-ch.js":5348,"./it.js":151,"./ja":9830,"./ja.js":9830,"./jv":3751,"./jv.js":3751,"./ka":3365,"./ka.js":3365,"./kk":5980,"./kk.js":5980,"./km":9571,"./km.js":9571,"./kn":5880,"./kn.js":5880,"./ko":6809,"./ko.js":6809,"./ku":6773,"./ku-kmr":257,"./ku-kmr.js":257,"./ku.js":6773,"./ky":5505,"./ky.js":5505,"./lb":553,"./lb.js":553,"./lo":1237,"./lo.js":1237,"./lt":1563,"./lt.js":1563,"./lv":1057,"./lv.js":1057,"./me":6495,"./me.js":6495,"./mi":3096,"./mi.js":3096,"./mk":3874,"./mk.js":3874,"./ml":6055,"./ml.js":6055,"./mn":7747,"./mn.js":7747,"./mr":7113,"./mr.js":7113,"./ms":8687,"./ms-my":7948,"./ms-my.js":7948,"./ms.js":8687,"./mt":4532,"./mt.js":4532,"./my":4655,"./my.js":4655,"./nb":6961,"./nb.js":6961,"./ne":2512,"./ne.js":2512,"./nl":8448,"./nl-be":2936,"./nl-be.js":2936,"./nl.js":8448,"./nn":9031,"./nn.js":9031,"./oc-lnc":5174,"./oc-lnc.js":5174,"./pa-in":118,"./pa-in.js":118,"./pl":3448,"./pl.js":3448,"./pt":3518,"./pt-br":2447,"./pt-br.js":2447,"./pt.js":3518,"./ro":817,"./ro.js":817,"./ru":262,"./ru.js":262,"./sd":8990,"./sd.js":8990,"./se":3842,"./se.js":3842,"./si":7711,"./si.js":7711,"./sk":756,"./sk.js":756,"./sl":3772,"./sl.js":3772,"./sq":6187,"./sq.js":6187,"./sr":732,"./sr-cyrl":5713,"./sr-cyrl.js":5713,"./sr.js":732,"./ss":9455,"./ss.js":9455,"./sv":9770,"./sv.js":9770,"./sw":959,"./sw.js":959,"./ta":6459,"./ta.js":6459,"./te":5302,"./te.js":5302,"./tet":7975,"./tet.js":7975,"./tg":1294,"./tg.js":1294,"./th":2385,"./th.js":2385,"./tk":4613,"./tk.js":4613,"./tl-ph":8668,"./tl-ph.js":8668,"./tlh":8190,"./tlh.js":8190,"./tr":4506,"./tr.js":4506,"./tzl":3440,"./tzl.js":3440,"./tzm":9852,"./tzm-latn":2350,"./tzm-latn.js":2350,"./tzm.js":9852,"./ug-cn":730,"./ug-cn.js":730,"./uk":99,"./uk.js":99,"./ur":2100,"./ur.js":2100,"./uz":6002,"./uz-latn":6322,"./uz-latn.js":6322,"./uz.js":6002,"./vi":4207,"./vi.js":4207,"./x-pseudo":4674,"./x-pseudo.js":4674,"./yo":570,"./yo.js":570,"./zh-cn":3644,"./zh-cn.js":3644,"./zh-hk":2591,"./zh-hk.js":2591,"./zh-mo":9503,"./zh-mo.js":9503,"./zh-tw":8080,"./zh-tw.js":8080};function n(s){var e=a(s);return t(e)}function a(s){if(!t.o(o,s)){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}return o[s]}n.keys=function(){return Object.keys(o)},n.resolve=a,s.exports=n,n.id=6700},5987:function(s,e,t){"use strict";var o=t(9242),n=t(1020),a=t(2483),r=(t(560),t(3396)),i=t(4870),l=t(7139);const c="http://127.0.0.1:5000/",u=(0,n.Q_)("authStore",{state:()=>({token:localStorage.getItem("token")?localStorage.getItem("token"):"",user:"",error:"",loader:!1}),actions:{async auth(s,e){this.loader=!0;const t=await fetch(c+s,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors",body:JSON.stringify(e)});if(this.loader=!1,!t.ok){const s=await t.json();return void(this.error=s.error)}const o=await t.json();this.token=o.token,this.user=o.user,localStorage.setItem("token",this.token),await Ae.push("chat")},async getUser(){const s=await fetch(c+"user?token="+localStorage.getItem("token"),{headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"});s.ok&&(this.user=await s.json())},getters:{isAuth(){return""!==this.user}}}});var d=t(5708),m=t(7629);const p={class:"container login-form",style:{"max-width":"50%"}},g=(0,r._)("h2",{style:{"padding-bottom":"8px","text-align":"center"}},"Логин",-1),h={class:"mb-3"},j=(0,r._)("label",{for:"inputUsername",class:"form-label"},"Имя пользователя",-1),v=(0,r._)("div",{id:"usernameHelp",class:"form-text"},"Введите имя пользователя",-1),f={class:"mb-3"},w=(0,r._)("label",{for:"inputPassword",class:"form-label"},"Пароль",-1),_=(0,r._)("div",{class:"mb-3 form-check"},[(0,r._)("input",{type:"checkbox",class:"form-check-input",id:"checkRemberMe"}),(0,r._)("label",{class:"form-check-label",for:"checkRemberMe"},"Запомнить меня")],-1),k={class:"mb-3"},b={class:"text-danger"},y={class:"mb-3"},S={class:"text-success"},U={class:"mb-3 center"},x=["disabled"],z={key:0,class:"d-flex justify-content-center"},D=(0,r._)("div",{class:"spinner-border",role:"status"},[(0,r._)("span",{class:"visually-hidden"},"Loading...")],-1),R=[D];var O={__name:"LoginComponent",setup(s){const e=u();(e.user||e.token)&&Ae.push("chat");const{meta:t,errors:n,defineField:a}=(0,d.cI)({validationSchema:m.Ry({username:m.Z_().required(),password:m.Z_().required().min(6).max(12)})}),[c,D]=a("username"),[O,C]=a("password"),M=(0,i.qj)({username:c,password:O,color:"#00000"});return(s,a)=>{const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("form",{onSubmit:a[2]||(a[2]=(0,o.iM)((s=>(0,i.SU)(e).auth("login",M)),["prevent"]))},[g,(0,r._)("div",h,[j,(0,r.wy)((0,r._)("input",(0,r.dG)({"onUpdate:modelValue":a[0]||(a[0]=s=>(0,i.dq)(c)?c.value=s:null)},(0,i.SU)(D),{type:"text",class:"form-control",id:"inputUsername"}),null,16),[[o.nr,(0,i.SU)(c)]]),v,(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(n).username),1)]),(0,r._)("div",f,[w,(0,r.wy)((0,r._)("input",(0,r.dG)({type:"password"},(0,i.SU)(C),{"onUpdate:modelValue":a[1]||(a[1]=s=>M.password=s),class:"form-control",id:"inputPassword"}),null,16),[[o.nr,M.password]]),(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(n).password),1)]),_,(0,r._)("div",k,[(0,r._)("span",b,(0,l.zw)((0,i.SU)(e).error),1)]),(0,r._)("div",y,[(0,r._)("span",S,(0,l.zw)((0,i.SU)(e).user),1)]),(0,r._)("div",U,[(0,r.Wm)(u,{to:{name:"register"},class:"btn btn-primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Создать аккаунт")])),_:1})]),(0,r._)("button",{disabled:!(0,i.SU)(t).valid,type:"submit",class:"btn btn-success"},"Войти ",8,x),(0,i.SU)(e).loader?((0,r.wg)(),(0,r.iD)("div",z,R)):(0,r.kq)("",!0)],32)])}}};const C=O;var M=C;const q={class:"container login-form",style:{"max-width":"50%"}},F=(0,r._)("h2",{style:{"padding-bottom":"8px","text-align":"center"}},"Регистрация",-1),L={class:"mb-3"},H=(0,r._)("label",{for:"inputUsername",class:"form-label"},"Имя пользователя",-1),P=(0,r._)("div",{id:"usernameHelp",class:"form-text"},"Введите имя пользователя",-1),T={class:"mb-3"},E=(0,r._)("label",{for:"inputPassword",class:"form-label"},"Пароль",-1),I={class:"mb-3"},W={class:"text-danger"},A={class:"mb-3"},V={class:"text-success"},Y={class:"mb-3 center"},Z=["disabled"],G={key:0,class:"d-flex justify-content-center"},N=(0,r._)("div",{class:"spinner-border",role:"status"},[(0,r._)("span",{class:"visually-hidden"},"Loading...")],-1),Q=[N];var K={__name:"RegisterComponent",setup(s){const e=u(),{meta:t,errors:n,defineField:a}=(0,d.cI)({validationSchema:m.Ry({username:m.Z_().required(),password:m.Z_().required().min(6).max(12)})}),[c,p]=a("username"),[g,h]=a("password"),j=(0,i.qj)({username:c,password:g});return(s,a)=>{const u=(0,r.up)("router-link");return(0,r.wg)(),(0,r.iD)("div",q,[(0,r._)("form",{onSubmit:a[2]||(a[2]=(0,o.iM)((s=>(0,i.SU)(e).auth("register",j)),["prevent"]))},[F,(0,r._)("div",L,[H,(0,r.wy)((0,r._)("input",(0,r.dG)({"onUpdate:modelValue":a[0]||(a[0]=s=>(0,i.dq)(c)?c.value=s:null)},(0,i.SU)(p),{type:"text",class:"form-control",id:"inputUsername"}),null,16),[[o.nr,(0,i.SU)(c)]]),P,(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(n).username),1)]),(0,r._)("div",T,[E,(0,r.wy)((0,r._)("input",(0,r.dG)({type:"password"},(0,i.SU)(h),{"onUpdate:modelValue":a[1]||(a[1]=s=>j.password=s),class:"form-control",id:"inputPassword"}),null,16),[[o.nr,j.password]]),(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(n).password),1)]),(0,r._)("div",I,[(0,r._)("span",W,(0,l.zw)((0,i.SU)(e).error),1)]),(0,r._)("div",A,[(0,r._)("span",V,(0,l.zw)((0,i.SU)(e).user),1)]),(0,r._)("div",Y,[(0,r.Wm)(u,{to:{name:"login"},class:"btn btn-primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Войти в аккаунт")])),_:1})]),(0,r._)("button",{disabled:!(0,i.SU)(t).valid,type:"submit",class:"btn btn-success"},"Создать аккаунт ",8,Z),(0,i.SU)(e).loader?((0,r.wg)(),(0,r.iD)("div",G,Q)):(0,r.kq)("",!0)],32)])}}};const $=K;var B=$;function J(s,e){const t=(0,r.up)("router-view");return(0,r.wg)(),(0,r.j4)(t)}var X=t(89);const ss={},es=(0,X.Z)(ss,[["render",J]]);var ts=es,os=t(4488);const ns="http://localhost:5000?token=",as=s=>(0,os.io)(ns+s,{autoConnect:!0}),rs=(0,n.Q_)("connection",{state:()=>({authStore:u(),isConnected:!1,socket:null}),actions:{bindEvents(){this.socket.on("connect",(()=>{this.isConnected=!0})),this.socket.on("disconnect",(()=>{this.isConnected=!1}))},connect(){this.socket=as(this.authStore.token),this.socket.connect()}}}),is="http://127.0.0.1:5000/",ls=(0,n.Q_)("roomStore",{state:()=>({auth:u(),roomList:[],currentRoom:localStorage.getItem("currentRoom")?JSON.parse(localStorage.getItem("currentRoom")):{},messages:[],error:"",loader:!1,loaderRoom:!1,isEmpty:!0,socketStore:rs()}),actions:{subscribeOnLocal(){this.$subscribe(((s,e)=>{localStorage.setItem("currentRoom",JSON.stringify(this.currentRoom))}))},async joinRoom(){this.socketStore.socket.emit("join",this.currentRoom)},async getRooms(){this.loaderRoom=!0;const s=await fetch(is+"rooms",{mode:"cors",credentials:"same-origin"});this.loaderRoom=!1,s.ok||(this.error=await s.json().error),this.roomList=await s.json()},async getMessages(){if(this.loader=!0,!this.currentRoom)return;const s=await fetch(is+"room/"+this.currentRoom.id,{mode:"cors",credentials:"same-origin"});if(this.loader=!1,!s.ok)return void(this.error=await s.json().error);const e=await s.json(),t=e.messages;this.isEmpty=0==t.length,this.messages=[];for(const o in t)this.messages.unshift(t[o]);return this.messages}},getters:{isAuth(){return""!==this.user}}});var cs=t(6797),us=t.n(cs);const ds={class:"row"},ms={class:"room-name col-auto"},ps={class:"col-auto room-last-message-date"},gs={class:"row"},hs={class:"col-6",style:{"word-break":"break-all"}},js={key:0,class:"room-last-message"},vs={key:1,class:"room-last-message"},fs=(0,r._)("div",{class:"col-4"},[(0,r._)("span",{class:"room-missed-message",style:{height:"20px",width:"20px"}},"8")],-1);var ws={__name:"RoomComponent",props:{room:{type:Object,required:!0,default:()=>{}}},setup(s){const e=ls(),t=s=>{if(s)return us()(String(s)).format("hh:mm DD.MM")},o=s=>s&&s.length>30?s.slice(0,30)+"...":s;return(n,a)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,l.C_)(["room",{active:s.room.id===(0,i.SU)(e).currentRoom.id}]),onClick:a[0]||(a[0]=e=>n.$emit("onRoomClick",s.room))},[(0,r._)("div",ds,[(0,r._)("span",ms,(0,l.zw)(s.room.name),1),(0,r._)("span",ps,(0,l.zw)(t(s.room.last_message.date)),1)]),(0,r._)("div",gs,[(0,r._)("div",hs,[s.room.last_message.text?((0,r.wg)(),(0,r.iD)("span",js,(0,l.zw)(o(s.room.last_message.text)),1)):((0,r.wg)(),(0,r.iD)("span",vs,"Нет сообщений"))]),fs])],2))}};const _s=ws;var ks=_s;const bs={class:"container m-0"},ys={key:0,class:"rooms"},Ss={key:1,class:"rooms d-flex justify-content-center"},Us=(0,r._)("div",{class:"spinner-border",role:"status"},[(0,r._)("span",{class:"visually-hidden"},"Loading...")],-1);var xs={__name:"RoomsList",setup(s){const e=ls();return e.getRooms(),e.joinRoom(),e.subscribeOnLocal(),e.getMessages(),(0,r.YP)((()=>e.currentRoom),((s,t)=>{e.joinRoom(),e.getMessages()}),{flush:"post"}),(s,t)=>((0,r.wg)(),(0,r.iD)("div",bs,[(0,i.SU)(e).loaderRoom?((0,r.wg)(),(0,r.iD)("div",Ss,[(0,r.Uk)(" Комнаты загружаются "),Us])):((0,r.wg)(),(0,r.iD)("div",ys,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,i.SU)(e).roomList,(s=>((0,r.wg)(),(0,r.j4)(ks,{onOnRoomClick:t=>(0,i.SU)(e).currentRoom=s,key:s.id,room:s},null,8,["onOnRoomClick","room"])))),128))]))]))}};const zs=xs;var Ds=zs;const Rs="http://localhost:5000/message/",Os=(0,n.Q_)("messageStore",{state:()=>({authStore:u(),room:ls(),socketStore:rs()}),actions:{sendMessage(s){s.room_id=this.room.currentRoom.id,this.socketStore.socket.emit("new_message",s)},async removeMessage(s){const e=await fetch(Rs+s.id,{method:"DELETE",headers:{Authorization:"Bearer "+this.authStore.token},credentials:"same-origin"});if(!e.ok)return;const t=this.room.messages.indexOf(s);-1!==t&&this.room.messages.splice(t,1)},subscribe(){this.socketStore.socket.on("join",(s=>{console.log(s)})),this.socketStore.socket.on("chat",(s=>{console.log(s),this.room.messages.push(s)})),this.socketStore.socket.on("delete",(s=>{this.removeMessage(s)}))}}}),Cs={key:0,class:"clearfix"},Ms={class:"message m-1"},qs={class:"row"},Fs={class:"col"},Ls={class:"row"},Hs={class:"col"},Ps={key:1,class:"clearfix"},Ts={class:"message-owner m-1"},Es={class:"row"},Is={class:"col"},Ws={class:"row"},As={class:"col"};var Vs={__name:"MessageComponent",props:{message:{type:Object,required:!0,default:()=>{}},isSender:{type:Boolean,required:!1,default:!1}},setup(s){Os();const e=s=>{if(s)return us()(String(s)).format("hh:mm")};return(t,o)=>s.isSender?((0,r.wg)(),(0,r.iD)("div",Ps,[(0,r._)("div",Ts,[(0,r._)("div",Es,[(0,r._)("div",Is,[(0,r._)("span",null,(0,l.zw)(s.message.user.username)+" "+(0,l.zw)(e(s.message.date)),1)])]),(0,r._)("div",Ws,[(0,r._)("div",As,[(0,r._)("span",null,(0,l.zw)(s.message.text),1)])])])])):((0,r.wg)(),(0,r.iD)("div",Cs,[(0,r._)("div",Ms,[(0,r._)("div",qs,[(0,r._)("div",Fs,[(0,r._)("span",null,(0,l.zw)(s.message.user.username)+" "+(0,l.zw)(e(s.message.date)),1)])]),(0,r._)("div",Ls,[(0,r._)("div",Hs,[(0,r._)("span",null,(0,l.zw)(s.message.text),1)])])])]))}};const Ys=Vs;var Zs=Ys,Gs=t.p+"img/send.0339349f.svg",Ns=t.p+"img/paperclip.834a86e0.svg";const Qs=(0,r._)("img",{class:"attach-img",src:Ns},null,-1),Ks=[Qs];var $s={__name:"AttachComponent",setup(s){const e=(0,i.iH)(null),t=s=>{};return(s,n)=>((0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("button",{class:"btn attach",onClick:n[0]||(n[0]=s=>e.value.click())},Ks),(0,r.wy)((0,r._)("input",{ref_key:"inputFile",ref:e,onChange:t,type:"file"},null,544),[[o.F8,!1]])],64))}};const Bs=$s;var Js=Bs;const Xs={class:"input"},se=(0,r._)("img",{class:"send-img",src:Gs},null,-1),ee=[se];var te={__name:"InputMessage",emits:["onMessageSend"],setup(s,{emit:e}){const t=(0,i.iH)(""),n=Os(),a=e;n.subscribe();const l=()=>{n.sendMessage({text:t.value,date:new Date}),t.value="",a("onMessageSend")};return(s,e)=>((0,r.wg)(),(0,r.iD)("div",Xs,[(0,r.Wm)(Js),(0,r.wy)((0,r._)("input",{onKeydown:(0,o.D2)(l,["enter"]),ref:"inputText","onUpdate:modelValue":e[0]||(e[0]=s=>t.value=s),minlength:"1",required:"",id:"message",type:"text",class:"form-control",placeholder:"Введите сообщение...","aria-label":"Default","aria-describedby":"inputGroup-sizing-default"},null,544),[[o.nr,t.value]]),(0,r._)("button",{onClick:l,class:"btn send-msg",id:"send_msg"},ee)]))}};const oe=te;var ne=oe;t(8858),t(1318),t(3228);const ae=(0,n.Q_)("attachmentsStore",{state:()=>({attachedFiles:[],errors:{}}),actions:{async uploadFile(s){this.attachedFiles.push(s)},clearAttachments(){this.attachedFiles.clear()},removeAttachment(s){const e=this.attachedFiles(s);-1!==e&&this.attachedFiles.splice(e,1)}},getters:{countAttachedFiles(){return this.attachedFiles.length}}}),re={class:"attached-files-list d-flex flex-wrap"},ie=(0,r._)("button",{class:"attached-file-remove"},null,-1),le=["src","alt"];var ce={__name:"AttachedFiles",setup(s){const e=ae(),t=s=>URL.createObjectURL(s);return(s,o)=>((0,r.wg)(),(0,r.iD)("div",re,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,i.SU)(e).attachedFiles,((s,e)=>((0,r.wg)(),(0,r.iD)("div",{key:e,class:"attached-file"},[ie,(0,r._)("img",{class:"attached-img",src:t(s),width:"150px",height:"170px",alt:`Фотография ${e+1}`},null,8,le)])))),128))]))}};const ue=ce;var de=ue;const me={class:"container control-container p-0"};var pe={__name:"ControlPanel",setup(s){return(s,e)=>((0,r.wg)(),(0,r.iD)("div",me,[(0,r.Wm)(ne,{onOnMessageSend:e[0]||(e[0]=e=>{s.$emit("onMessageSend"),console.log("scroll control")})}),(0,r.Wm)(de)]))}};const ge=pe;var he=ge;const je={key:0};var ve={__name:"UploadFile",setup(s){const e=ae(),t=(0,i.iH)(null),o=(0,i.iH)(!1),n=s=>{for(let t=0;t<s.target.files.length;t++)e.uploadFile(s.target.files[t]);t.value&&(t.value.value=""),o.value=!1};return(s,e)=>((0,r.wg)(),(0,r.iD)("div",{class:(0,l.C_)(["input-wrapper",{dragged:o.value}])},[o.value?((0,r.wg)(),(0,r.iD)("span",je,"Перетащите сюда файл")):(0,r.kq)("",!0),(0,r._)("input",{ref:t.value,onChange:n,class:"draggedFile",title:"",type:"file",multiple:"",onDragenter:e[0]||(e[0]=s=>o.value=!0),onDragleave:e[1]||(e[1]=s=>o.value=!1)},null,544)],2))}};const fe=ve;var we=fe;const _e={class:"col-8 chat-window",style:{padding:"0"}},ke={key:0,class:"text-center"},be={class:"messages"},ye={key:1,class:"d-flex justify-content-center"},Se=(0,r._)("div",{class:"spinner-border",role:"status"},[(0,r._)("span",{class:"visually-hidden"},"Loading...")],-1),Ue=[Se],xe={class:"control"};var ze={__name:"MessagesList",props:{messages:{type:Object,required:!0,default:()=>{}}},setup(s){const e=ls(),t=u(),o=rs(),n=s,a=(0,i.iH)(null);(0,i.iH)(0),(0,i.iH)(50);o.socket.on("notify",(s=>{l()})),o.socket.on("chat",(s=>{l()})),(0,r.YP)((()=>n.messages),((s,e)=>{l()}),{flush:"post"});const l=()=>{console.log("scroll"),a.value.scrollTop=a.value.scrollHeight},c=()=>{a.value.scrollTop<=5&&console.log("Подгрузить сообщения")};return(o,n)=>((0,r.wg)(),(0,r.iD)("div",_e,[(0,r.Wm)(we),(0,r._)("div",{class:"container chat-message",onScroll:c,ref_key:"messageList",ref:a},[0==s.messages.length?((0,r.wg)(),(0,r.iD)("p",ke,"В комнате нет сообщений")):(0,r.kq)("",!0),(0,r._)("div",be,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.messages,(s=>((0,r.wg)(),(0,r.j4)(Zs,{key:s.id,message:s,isSender:s.user.id===(0,i.SU)(t).user.id},null,8,["message","isSender"])))),128))]),(0,i.SU)(e).loader?((0,r.wg)(),(0,r.iD)("div",ye,Ue)):(0,r.kq)("",!0),(0,r._)("div",xe,[(0,r.Wm)(he,{onOnMessageSend:l})])],544)]))}};const De=ze;var Re=De;const Oe={class:"container-fluid window"},Ce={class:"d-flex flex-column"},Me=(0,r._)("br",null,null,-1),qe=(0,r._)("br",null,null,-1),Fe={class:"row m-1"},Le={class:"col-4 room-window",style:{padding:"0"}},He={key:1,class:"col-8 no-message",style:{padding:"0"}},Pe=(0,r._)("p",{class:"chat-placeholder"},"Выберите комнату чтобы увидеть сообщения",-1),Te=[Pe];var Ee={__name:"ChatView",setup(s){const e=u(),t=ls(),o=rs();return e.getUser(),o.connect(),o.bindEvents(),(s,n)=>((0,r.wg)(),(0,r.iD)("div",Oe,[(0,r._)("div",Ce,[(0,r.Uk)((0,l.zw)((0,i.SU)(o).isConnected),1),Me,(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(e).token),1),qe,(0,r.Uk)(" "+(0,l.zw)((0,i.SU)(e).user),1)]),(0,r._)("div",Fe,[(0,r._)("div",Le,[(0,r.Wm)(Ds)]),(0,i.SU)(t).currentRoom?((0,r.wg)(),(0,r.j4)(Re,{key:0,messages:(0,i.SU)(t).messages},null,8,["messages"])):((0,r.wg)(),(0,r.iD)("div",He,Te))])]))}};const Ie=Ee;var We=Ie,Ae=(0,a.p7)({history:(0,a.PO)(),routes:[{path:"/",redirect:{name:"login"},component:ts,children:[{name:"login",path:"/login",component:M},{name:"register",path:"/register",component:B}]},{path:"/rooms",name:"rooms",component:Ds},{path:"/chat",name:"chat",component:We},{path:"/:pathMatch(.*)",component:Ds}]});function Ve(s,e){const t=(0,r.up)("router-view");return(0,r.wg)(),(0,r.j4)(t)}const Ye={},Ze=(0,X.Z)(Ye,[["render",Ve]]);var Ge=Ze;t(2166);(0,o.ri)(Ge).use(Ae).use((0,n.WB)()).mount("#app")}},e={};function t(o){var n=e[o];if(void 0!==n)return n.exports;var a=e[o]={id:o,loaded:!1,exports:{}};return s[o].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}t.m=s,function(){var s=[];t.O=function(e,o,n,a){if(!o){var r=1/0;for(u=0;u<s.length;u++){o=s[u][0],n=s[u][1],a=s[u][2];for(var i=!0,l=0;l<o.length;l++)(!1&a||r>=a)&&Object.keys(t.O).every((function(s){return t.O[s](o[l])}))?o.splice(l--,1):(i=!1,a<r&&(r=a));if(i){s.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=s.length;u>0&&s[u-1][2]>a;u--)s[u]=s[u-1];s[u]=[o,n,a]}}(),function(){t.n=function(s){var e=s&&s.__esModule?function(){return s["default"]}:function(){return s};return t.d(e,{a:e}),e}}(),function(){t.d=function(s,e){for(var o in e)t.o(e,o)&&!t.o(s,o)&&Object.defineProperty(s,o,{enumerable:!0,get:e[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(s){if("object"===typeof window)return window}}()}(),function(){t.o=function(s,e){return Object.prototype.hasOwnProperty.call(s,e)}}(),function(){t.r=function(s){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})}}(),function(){t.nmd=function(s){return s.paths=[],s.children||(s.children=[]),s}}(),function(){t.p="/"}(),function(){var s={143:0};t.O.j=function(e){return 0===s[e]};var e=function(e,o){var n,a,r=o[0],i=o[1],l=o[2],c=0;if(r.some((function(e){return 0!==s[e]}))){for(n in i)t.o(i,n)&&(t.m[n]=i[n]);if(l)var u=l(t)}for(e&&e(o);c<r.length;c++)a=r[c],t.o(s,a)&&s[a]&&s[a][0](),s[a]=0;return t.O(u)},o=self["webpackChunkchat"]=self["webpackChunkchat"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(5987)}));o=t.O(o)})();
//# sourceMappingURL=app.0743f212.js.map